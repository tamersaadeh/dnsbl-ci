dist: bionic

language: python
python:
  - "3.8"

script: 
  - python ./convertlists.py lists.json $HOME/ci/converted/ -vv
  - python ./buildrepo.py $HOME/ci/converted/ $HOME/ci/built/ --downloadbaseurl https://tamersaadeh.github.io/dnsbl-justdomains/ -vv

deploy:
  - provider: pages:git
    repo: tamersaadeh/dnsbl-justdomains
    commit_message: Updated lists as of $(date +%Y-%m-%d)
    name: JustDomains CI
    email: justdomains-ci
    target_branch: master
    local_dir: $HOME/ci/built/
    verbose: true
    script: .ci/deploy.sh $HOME/ci/built/
    on:
      branch: master

branches:
  only:
    - master
